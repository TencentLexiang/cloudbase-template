{
  "version": "2.0",
  "envId": "{{env.ENV_ID}}",
  "framework": {
    "name": "lxservice",
    "plugins": {
      "function": {
        "use": "@cloudbase/framework-plugin-function",
        "inputs": {
          "functionRootPath": "./functions",
          "servicePaths": {
            "login_user": "/login_user",
            "suite_callback": "/suite_callback",
            "get_course_link": "/get_course_link"
          }
        }
      },
      "database": {
        "use": "@cloudbase/framework-plugin-database",
        "inputs": {
          "collections": [
            {
              "collectionName": "lx_suite_callback_logs",
              "createIndexes": [
                {
                  "name": "lx_suite_callback_logs_action_index",
                  "unique": false,
                  "keys": [
                    {
                      "name": "action",
                      "direction": "1"
                    }
                  ]
                }
              ]
            },
            {
              "collectionName": "lx_suites"
            },
            {
              "collectionName": "companies"
            },
            {
              "collectionName": "users"
            },
            {
              "collectionName": "departments",
              "createIndexes": [
                {
                  "name": "departments_company_id_version_index",
                  "unique": false,
                  "keys": [
                    {
                      "name": "company_id",
                      "direction": "1"
                    },
                    {
                      "name": "version",
                      "direction": "1"
                    }
                  ]
                }
              ]
            },
            {
              "collectionName": "department_user"
            }
          ]
        }
      }
    },
    "hooks": {
      "preDeploy": {
        "type": "execCommand",
        "commands": [
          "cd vue && yarn install",
          "cd vue && yarn build",
          "tcb hosting deploy ./vue/dist -e {{env.ENV_ID}}"
        ]
      },
      "postDeploy": {
        "type": "callFunction",
        "functions": []
      }
    }
  },
  "functionRoot": "./functions",
  "functions": [
    {
      "name": "suite_callback",
      "runtime": "Nodejs10.15",
      "handler": "index.main",
      "timeout": 5,
      "memorySize": 128,
      "envVariables": {
        "LX_SUITE_ID": "{{env.LX_SUITE_ID}}"
      },
      "installDependency": false
    },
    {
      "name": "get_suite_access_token",
      "runtime": "Nodejs10.15",
      "handler": "index.main",
      "timeout": 5,
      "memorySize": 128,
      "envVariables": {
        "LX_SUITE_ID": "{{env.LX_SUITE_ID}}",
        "LX_SUITE_SECRET": "{{env.LX_SUITE_SECRET}}",
        "LX_API_URL": "{{env.LX_API_URL}}"
      },
      "triggers": [
        {
          "name": "get_suite_access_token",
          "type": "timer",
          "config": "0 */30 * * * * *"
        }
      ],
      "installDependency": false,
      "publicNet": "ENABLE",
      "eip": "ENABLE"
    },
    {
      "name": "get_corp_info",
      "runtime": "Nodejs10.15",
      "handler": "index.main",
      "timeout": 5,
      "memorySize": 128,
      "envVariables": {
        "LX_API_URL": "{{env.LX_API_URL}}"
      },
      "installDependency": false,
      "publicNet": "ENABLE",
      "eip": "ENABLE"
    },
    {
      "name": "get_user_info",
      "runtime": "Nodejs10.15",
      "handler": "index.main",
      "timeout": 5,
      "memorySize": 128,
      "envVariables": {
        "LX_API_URL": "{{env.LX_API_URL}}"
      },
      "installDependency": false,
      "publicNet": "ENABLE",
      "eip": "ENABLE"
    },
    {
      "name": "get_corp_token",
      "runtime": "Nodejs10.15",
      "handler": "index.main",
      "timeout": 5,
      "memorySize": 128,
      "envVariables": {
        "LX_API_URL": "{{env.LX_API_URL}}"
      },
      "triggers": [
        {
          "name": "get_corp_token",
          "type": "timer",
          "config": "0 */30 * * * * *"
        }
      ],
      "installDependency": false,
      "publicNet": "ENABLE",
      "eip": "ENABLE"
    },
    {
      "name": "login_user",
      "runtime": "Nodejs10.15",
      "handler": "index.main",
      "timeout": 5,
      "memorySize": 128,
      "envVariables": {
        "ENV_ID": "{{env.ENV_ID}}",
        "LX_API_URL": "{{env.LX_API_URL}}"
      },
      "installDependency": false
    },
    {
      "name": "sync_contact",
      "runtime": "Nodejs10.15",
      "handler": "index.main",
      "timeout": 60,
      "memorySize": 2048,
      "envVariables": {
        "LX_API_URL": "{{env.LX_API_URL}}"
      },
      "installDependency": false,
      "publicNet": "ENABLE",
      "eip": "ENABLE"
    },
    {
      "name": "post_course",
      "runtime": "Nodejs10.15",
      "handler": "index.main",
      "timeout": 5,
      "memorySize": 128,
      "envVariables": {
        "LX_API_URL": "{{env.LX_API_URL}}"
      },
      "installDependency": false,
      "publicNet": "ENABLE",
      "eip": "ENABLE"
    }
  ],
  "region": "ap-guangzhou"
}
